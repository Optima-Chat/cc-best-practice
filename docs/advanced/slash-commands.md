# Slash Commands 自定义命令

Slash Commands 让你可以创建可重用的命令，简化重复性工作。

## 基础用法

### 创建命令

在项目根目录创建 `.claude/commands/` 目录，然后添加 `.md` 文件：

```bash
mkdir -p .claude/commands
```

### 示例：代码审查命令

创建 `.claude/commands/review.md`：

```markdown
请审查最近的代码变更，关注以下方面：

1. **代码质量**
   - 是否遵循项目的编码规范
   - 命名是否清晰明确
   - 是否有重复代码

2. **潜在问题**
   - 可能的 bug
   - 边界条件处理
   - 错误处理

3. **性能**
   - 是否有性能瓶颈
   - 不必要的计算或查询

4. **安全性**
   - 输入验证
   - 敏感数据处理

请使用 git diff 查看变更，并提供具体的改进建议。
```

使用：`/review`

## 实用命令示例

### 测试命令

`.claude/commands/test.md`：

```markdown
请运行项目的测试套件：

1. 运行所有测试
2. 如果有失败，分析原因
3. 修复失败的测试
4. 重新运行确保通过
5. 报告测试覆盖率
```

### 重构命令

`.claude/commands/refactor.md`：

```markdown
请对指定的代码进行重构优化：

1. 分析当前代码结构
2. 识别改进空间：
   - 复杂度降低
   - 可读性提升
   - 设计模式应用
3. 提出重构方案
4. 实施重构（需要用户确认）
5. 确保测试通过
```

### 文档生成命令

`.claude/commands/doc.md`：

```markdown
为指定的代码生成文档：

1. 分析代码结构和功能
2. 生成详细的 JSDoc/注释
3. 更新 README.md（如需要）
4. 添加使用示例
5. 标注注意事项和限制
```

### 部署检查命令

`.claude/commands/deploy-check.md`：

```markdown
执行部署前检查：

1. ✅ 运行 linter
2. ✅ 运行测试套件
3. ✅ 构建生产版本
4. ✅ 检查环境变量配置
5. ✅ 验证依赖版本
6. ✅ 检查安全漏洞 (npm audit)
7. 📋 生成变更日志

如果所有检查通过，确认可以部署。
```

### 性能分析命令

`.claude/commands/perf.md`：

```markdown
分析项目性能：

1. 检查打包体积
2. 分析依赖大小
3. 识别性能瓶颈：
   - 大型依赖
   - 未使用的代码
   - 可优化的导入
4. 提供优化建议
5. 实施改进（需确认）
```

## 进阶技巧

### 参数化命令

虽然 Slash Commands 不直接支持参数，但可以在命令中引导 Claude Code 询问：

```markdown
# /setup-component

创建一个新的 React 组件：

1. 询问用户组件名称
2. 询问组件类型（函数组件/类组件）
3. 创建组件文件
4. 创建样式文件
5. 创建测试文件
6. 更新导出
```

### 组合命令

创建调用其他命令的主命令：

```markdown
# /full-review

执行完整的代码审查流程：

1. 先执行 /test 确保测试通过
2. 执行 /review 审查代码质量
3. 执行 /perf 检查性能
4. 生成审查报告
```

### 项目特定命令

在项目的 `.claude/commands/` 中创建针对项目的命令：

```markdown
# /api-update

更新 API 客户端代码：

1. 从 {API_SPEC_URL} 获取最新的 OpenAPI 规范
2. 对比本地版本识别变更
3. 更新 TypeScript 类型定义
4. 更新 API 客户端方法
5. 更新相关测试
6. 验证构建通过
```

## 最佳实践

### 1. 清晰的命令名称

- ✅ `/test-coverage` - 明确
- ❌ `/tc` - 难以理解

### 2. 结构化的指令

使用编号列表、分组，让命令易于执行：

```markdown
## 步骤 1: 准备
- 检查环境
- 备份数据

## 步骤 2: 执行
- 运行迁移
- 验证结果

## 步骤 3: 清理
- 删除临时文件
- 更新文档
```

### 3. 包含上下文

在命令中说明项目规范：

```markdown
请遵循项目的编码规范：
- 使用 TypeScript 严格模式
- 组件使用函数式写法
- 样式使用 CSS Modules
```

### 4. 安全检查

对危险操作添加确认步骤：

```markdown
⚠️ 警告：此操作将删除数据

请先：
1. 显示将要删除的内容
2. 等待用户明确确认
3. 然后执行删除
```

## 命令管理

### 查看可用命令

```bash
ls .claude/commands/
```

### 全局 vs 项目命令

- **全局命令**: `~/.claude/commands/`（所有项目可用）
- **项目命令**: `./.claude/commands/`（仅当前项目）

项目命令优先级更高。

### 版本控制

将 `.claude/commands/` 提交到 Git，让团队共享：

```bash
git add .claude/commands/
git commit -m "添加团队共享的 Claude Code 命令"
```

## 调试命令

如果命令没有按预期工作：

1. **检查文件位置**：确保在正确的目录
2. **验证语法**：确保 Markdown 格式正确
3. **测试执行**：尝试简化命令内容
4. **查看日志**：观察 Claude Code 的执行过程

## 下一步

- 学习[自定义 Hooks](./hooks.md)
- 探索[提示词工程](./prompt-engineering.md)
- 查看[实战案例](../examples/README.md)
