# Claude Code 最佳实践

> 使用 Claude Code 的正确姿势：先想清楚，再动手

## 最重要的一条原则

很多人在使用 Claude Code 时会犯一个严重的错误：一上来就让它开始写代码。你可能会说"帮我实现一个用户认证功能"，然后 Claude Code 就开始噼里啪啦地写代码了。写到一半你突然发现，诶，这个方案好像不太对，于是推倒重来。这样反反复复，本来半小时能完成的事情，最后花了好几个小时。

正确的做法是什么呢？**先花时间讨论技术方案，把所有细节都想清楚，然后再开始写代码**。这听起来好像会更慢，但实际上会快得多。为什么？因为当你和 Claude Code 花一两个小时把技术方案讨论透彻之后，真正写代码可能只需要十几二十分钟。而如果你一开始方案没想好就动手，后面的返工时间可能是几个小时甚至几天。

我们有一个黄金法则：**你花在讨论方案上的时间，能帮你省下至少十倍的返工时间**。一个小时的深入讨论，可以省下十个小时的痛苦返工。这笔账，怎么算都划算。

## 如何正确地讨论技术方案

当你有一个新功能要实现时，不要急着让 Claude Code 写代码。先跟它说："我想实现某某功能，我们先不写代码，来讨论一下技术方案。"然后开始提问题：整体架构应该是什么样的？需要哪些核心模块？数据流是怎样的？有哪些技术选型需要考虑？可能会遇到什么坑？

在讨论的过程中，**对于任何你不理解的地方，一定要问清楚**。不要不好意思问"笨"问题。Claude Code 提到要用 Redis 做缓存？问问它为什么不用 Memcached。它说这个中间件的执行顺序要这样安排？问问它为什么。它建议用 WebSocket 而不是轮询？问问它两者的区别和适用场景。这个数据结构为什么要这样设计？都要问清楚。

**你必须完全理解方案的每一个部分**。不要似懂非懂就开始写代码，那样最后吃亏的是你自己。当你觉得方案的每个环节都理解了，可以用自己的话把整个方案总结一遍，然后问 Claude Code："我这样理解对吗？还有什么需要补充的？"确认无误之后，再开始实现。

## 把技术方案写下来

讨论完技术方案之后，**一定要把它记录下来**。在项目根目录下建一个 docs 文件夹，把技术方案、架构设计、重要的技术决策都保存在里面。可以让 Claude Code 帮你整理成文档，格式清晰，方便后续查阅。

为什么要这样做？因为过一段时间你可能会忘记当初为什么要这样设计。当新同事加入项目，或者你需要在这个方案基础上做扩展时，这些文档会非常有用。而且在讨论过程中，Claude Code 可能会画一些架构图、数据流图、时序图，这些都应该保存到 docs 目录下。图比文字更直观，更容易理解。

当你让 Claude Code 帮你整理技术方案文档时，可以说："请把我们刚才讨论的方案整理成文档，保存到 @docs 目录"。这样你的技术方案就有了完整的记录，项目的知识也得到了沉淀。

## 一个真实的案例

让我们看一个真实的例子。假设你要实现一个电商网站的购物车功能。

**错误的做法**是这样的：你直接说"帮我实现购物车功能"，Claude Code 开始写代码。写了半小时之后，你突然想起来："等等，我需要支持多规格商品，比如同一件衣服有不同的尺寸和颜色。"Claude Code 开始修改代码。又过了一小时，你又说："购物车数据要存在服务端，不是浏览器本地。"这又是一次大改。再过一会儿："还要支持优惠券计算。"继续改。这样折腾下来，三个小时过去了，代码改了无数遍，Claude Code 累，你也累。

**正确的做法**是这样的：一开始你就把需求说清楚："我想实现购物车功能，先讨论一下技术方案。需求包括：支持多规格商品（尺寸、颜色等），购物车数据要存在服务端，要支持优惠券，要能检查库存，而且游客和登录用户都要能用。请给出完整的技术方案。"

然后 Claude Code 会给你一个详细的方案，包括数据结构怎么设计、API 怎么设计、前端状态怎么管理。你看到方案里提到游客购物车用 sessionId，你问："为什么不用 localStorage？"Claude Code 解释原因。你又问："多规格商品的 SKU 怎么设计？"Claude Code 详细说明。经过一个小时的讨论，方案完全确定了，而且你对每个细节都很清楚。

然后你说："好的，按照我们讨论的方案开始实现。先把技术方案文档整理一下保存到 docs 目录，然后开始写代码。"Claude Code 先整理文档，然后开始实现。二十分钟后，代码写完了，一次到位，基本不需要改。总共花了一个半小时，比错误做法省了一半时间，而且代码质量更高，技术方案也有了完整记录。

## 再看一个性能优化的例子

假设你的 API 响应很慢，要三秒钟。**错误的做法**是直接说"这个 API 很慢，帮我优化"。Claude Code 开始加缓存、加索引，折腾半天效果不明显。你问为什么还是慢，它继续尝试其他方法。这样盲目地试来试去，既浪费时间，也可能把问题搞得更复杂。

**正确的做法**是先分析问题："这个 API 响应时间三秒，我们先分析一下原因。请帮我分析慢在哪里，是数据库查询、网络传输还是计算密集？然后列出可能的优化方案，评估每个方案的收益和成本，给出优先级建议。"

Claude Code 分析后告诉你主要问题是 N+1 查询。你不太懂什么是 N+1，就问清楚。它解释完之后，你又问如果用 JOIN 代替，对数据库压力有多大。讨论了半小时，方案确定了：用 JOIN 解决 N+1 问题，再加上 Redis 缓存热点数据。然后让它把优化方案整理成文档保存到 docs，接着开始实现。实现完成后，API 响应时间降到了 200 毫秒。整个过程清晰明了，效果显著，而且优化思路也记录在案了。

## 什么时候适合这样做

这个方法特别适合那些复杂的、有技术挑战的任务。比如开发新功能、做架构设计、性能优化、代码重构、技术选型，这些都应该先讨论方案。而对于一些简单的任务，比如修个小 bug、改改文案、调整样式，就不必这么正式了，直接让 Claude Code 改就行。

关键是要判断任务的复杂度。如果这个任务涉及到多个模块、需要做技术决策、可能会影响系统架构，那就值得花时间讨论方案。如果只是改几行代码的事儿，就别浪费时间了。

## 让 Claude Code 画图

在讨论技术方案的时候，别只是文字交流，**让 Claude Code 画图**。架构图能让你直观地看到系统的各个部分是如何组织的。数据流图能展示数据是如何在系统中流转的。时序图能清楚地表现各个组件的交互顺序。如果涉及数据库设计，ER 图能帮你理解表之间的关系。

图比文字更容易理解，而且这些图也应该保存到 docs 目录下，成为技术文档的一部分。以后你回过头来看，或者给别人讲解时，这些图都非常有用。

## 多方案对比

当面临技术选型或设计决策时，不要只让 Claude Code 给一个方案，**让它给出多个方案并进行对比**。比如可以说："请给出三种不同的实现方案：一个是最简单快速能上线的，一个是性能最优的，一个是最灵活可扩展的。然后分析每个方案的优缺点。"

这样你就能从多个角度看问题，权衡利弊，做出更明智的决策。有时候最优雅的方案不一定是最合适的，要根据项目的实际情况来选择。把这些方案对比也记录到 docs 里，解释为什么选择了这个方案而不是那个，这对将来很有价值。

## 开始实践吧

下次使用 Claude Code 时，试试这个方法：先讨论方案，花一两个小时把所有细节都问清楚，完全理解每一个技术决策。把方案整理成文档保存到 docs 目录。然后再开始写代码，你会发现代码写得又快又好。如果发现方案有问题，及时停下来重新讨论，不要硬着头皮继续写。

记住：慢就是快。在方案上多花时间，在代码上就能省时间。想清楚再动手，磨刀不误砍柴工。

---

## 文档目录说明

本项目的 `docs` 目录用于存放各种技术方案文档、架构设计、最佳实践案例等。当你在使用 Claude Code 时讨论出好的技术方案，或者遇到值得记录的经验，都可以整理成文档放在这里。

目录结构：
- `docs/basics/` - 基础知识和概念
- `docs/advanced/` - 进阶技巧
- `docs/examples/` - 实战案例
- `docs/best-practices/` - 最佳实践

## 贡献

欢迎分享你使用 Claude Code 的经验和最佳实践。如果你有好的技术方案文档、案例或技巧，欢迎贡献到本项目。

## 社区

- [CC Chat 社区](https://github.com/optima-chat/cc-chat) - Claude Code 中文聊天社区
- [GitHub Discussions](../../discussions) - 讨论和交流

## 许可证

MIT
